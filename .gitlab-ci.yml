variables:
    # The host for the test SGame instance
    SGAME_HOST: "localhost"
    # The port for the test SGame instance
    SGAME_PORT: "5000"

stages:
    - build
    - test

# Build stage: build the C# SGame executable
build:
    stage: build
    before_script:
        # Before building: restore C# dependencies for SGame
        - dotnet restore SGame
    script:
        - dotnet build SGame

# Test stage
test:
    stage: test
    script:
        # Run automated tests via pytest
        # (See issue #33 for why this in its own script; otherwise, GitLab will
        #  stall until timeout because the SGame process in the background won't terminate!)
        - cd ${CI_PROJECT_DIR}
        - bash ci/runtests.sh ${SGAME_HOST} ${SGAME_PORT}
